$NetBSD: patch-package_man,v 1.5 2018/12/16 06:09:20 schmonz Exp $

Support DESTDIR. Avoid nroff.

--- package/man.orig	2018-11-10 19:42:10.000000000 +0000
+++ package/man
@@ -10,20 +10,11 @@ mandir=""
 usemanpath=0
 usemandoc=0
 
-if [ `which manpath` 2>/dev/null ]
-then
-	usemanpath=1
-fi
-
-if [ `which mandoc`  2>/dev/null ]
-then 
-  usemandoc=1
-  shout "Using mandoc facility for man files."
-fi
-
 safe umask 022
 [ -d man ] || barf "no man directory"
 
+destdir=`head -1 conf-destdir`
+
 if [ -f conf-man ]
 then
    mandir=`head -1 conf-man`
@@ -49,16 +40,18 @@ else 
 fi
 
 cd man
+if false; then
 if [ $usemandoc -eq 1 ]
 then
   safe make -f Makefile.mandoc
 else
   safe make 
 fi
+fi
 
 if [ $usemandoc -eq 0 ]
 then
-  shout "Installing ${me} compressed man-files in ${mandir}."
+  shout "Installing ${me} man-files in ${mandir}."
 else
   shout "Installing ${me} un-compressed man-files in ${mandir}."
 fi
@@ -71,11 +64,11 @@ done
 for manfile in $all
 do
   dir="man`echo $manfile | awk -F. '{print $NF}'`"
-  [ -d $mandir/$dir ] || safe mkdir $mandir/$dir
+  [ -d $destdir/$mandir/$dir ] || safe mkdir $destdir/$mandir/$dir
   if [ $usemandoc -eq 0 ]
   then
     safe gzip $manfile && \
-         cp "$manfile.gz" "$mandir/$dir/$manfile.gz"
+         cp "$manfile.gz" "$destdir/$mandir/$dir/$manfile.gz"
   else
     safe cp "$manfile" "$mandir/$dir/$manfile"
   fi
@@ -83,6 +76,7 @@ done
 
 ## nroff: Required for old catman systems only 
 
+if false; then
 if [ $usemandoc -eq 0 ]
 then
   shout "Installing ${me} nroff'ed man-files in ${mandir}/catX."
@@ -119,6 +113,7 @@ else
      shout "Installing ${me} mandoc files in db (man -w)."
   fi 
 fi
+fi
 
 cd ..
 
